<!DOCTYPE html>
<html>
<head>
    <title>Add / Update Records</title>
    <style>
        body { font-family: Menlo, monospace; background:#111; color:#eee; text-align:center; }
        table { border-collapse:collapse; margin:20px auto; }
        th, td { border:1px solid #555; padding:6px 12px; }
        th { background:#333; }
        input, select { padding:4px 6px; margin:4px; width:260px; }
        button { padding:6px 12px; margin:5px; }
        .msg { color:#8f8; margin-top:10px; }
        .err { color:#ff8080; margin-top:10px; }
        .formrow { margin:3px; }
        label { display:inline-block; width:140px; text-align:right; margin-right:5px; }
        .section { margin-top:10px; }
    </style>
</head>
<body>

<h1>Add / Update Records</h1>

<form method="post">

  <!-- Table selector -->
  <div class="formrow">
    <label>Table:</label>
    <select id="table-select" name="table">
      {% set sel = (selected_table or 'CUSTOMER') %}
      <option value="CUSTOMER" {% if sel == 'CUSTOMER' %}selected{% endif %}>Customer</option>
      <option value="VEHICLE"  {% if sel == 'VEHICLE'  %}selected{% endif %}>Vehicle</option>
      <option value="RENTAL"   {% if sel == 'RENTAL'   %}selected{% endif %}>Rental</option>
      <option value="PAYMENT"  {% if sel == 'PAYMENT'  %}selected{% endif %}>Payment</option>
    </select>
  </div>

  <!-- CUSTOMER FIELDS -->
  <div id="section-CUSTOMER" class="section">
    <div class="formrow">
      <label>Customer_ID:</label>
      <input type="number" name="customer_id">
    </div>
    <div class="formrow">
      <label>Full_Name:</label>
      <input type="text" name="full_name">
    </div>
    <div class="formrow">
      <label>Email:</label>
      <input type="email" name="email">
    </div>
    <div class="formrow">
      <label>Phone:</label>
      <input type="text" name="phone">
    </div>
    <div class="formrow">
      <label>Address:</label>
      <input type="text" name="address">
    </div>
    <div class="formrow">
      <label>Drivers_License:</label>
      <input type="text" name="dl">
    </div>
  </div>

  <!-- VEHICLE FIELDS -->
  <div id="section-VEHICLE" class="section">
    <div class="formrow">
      <label>Vehicle_ID:</label>
      <input type="number" name="vehicle_id">
    </div>
    <div class="formrow">
      <label>License_Plate:</label>
      <input type="text" name="license_plate">
    </div>
    <div class="formrow">
      <label>Vehicle_Make:</label>
      <input type="text" name="vehicle_make">
    </div>
    <div class="formrow">
      <label>Vehicle_Model:</label>
      <input type="text" name="vehicle_model">
    </div>
    <div class="formrow">
      <label>Vehicle_Year:</label>
      <input type="number" name="vehicle_year">
    </div>
    <div class="formrow">
      <label>Vehicle_VIN:</label>
      <input type="text" name="vehicle_vin">
    </div>
  </div>

  <!-- RENTAL FIELDS -->
  <div id="section-RENTAL" class="section">
    <div class="formrow">
      <label>Rental_ID:</label>
      <input type="number" name="rental_id">
    </div>
    <div class="formrow">
      <label>Customer_ID:</label>
      <input type="number" name="customer_id">
    </div>
    <div class="formrow">
      <label>Vehicle_ID:</label>
      <input type="number" name="vehicle_id">
    </div>
    <div class="formrow">
      <label>Rental_Duration:</label>
      <input type="number" name="rental_duration">
    </div>
    <div class="formrow">
      <label>Pickup_Date:</label>
      <input type="text" name="pickup_date" placeholder="YYYY-MM-DD">
    </div>
    <div class="formrow">
      <label>Return_Date:</label>
      <input type="text" name="return_date" placeholder="YYYY-MM-DD (optional)">
    </div>
    <div class="formrow">
      <label>Rental_Rate:</label>
      <input type="number" step="0.01" name="rental_rate">
    </div>
  </div>

  <!-- PAYMENT FIELDS -->
  <div id="section-PAYMENT" class="section">
    <div class="formrow">
      <label>Payment_ID:</label>
      <input type="number" name="payment_id">
    </div>
    <div class="formrow">
      <label>Customer_ID:</label>
      <input type="number" name="customer_id">
    </div>
    <div class="formrow">
      <label>Rental_ID:</label>
      <input type="number" name="rental_id">
    </div>
    <div class="formrow">
      <label>Payment_Amount:</label>
      <input type="number" step="0.01" name="payment_amount">
    </div>
    <div class="formrow">
      <label>Status:</label>
      <input type="text" name="status" placeholder="PENDING / PAID / ...">
    </div>
  </div>

  <button type="submit">Save Record</button>
</form>

{% if message %}
  <div class="msg">{{ message }}</div>
{% endif %}
{% if error %}
  <div class="err">{{ error }}</div>
{% endif %}

{% if rows %}
  <h2>Current {{ selected_table }} Records</h2>
  <table>
    <tr>
      {% for c in cols %}<th>{{ c }}</th>{% endfor %}
    </tr>
    {% for r in rows %}
      <tr>
        {% for c in r %}<td>{{ c }}</td>{% endfor %}
      </tr>
    {% endfor %}
  </table>
{% endif %}

{# ---- NEW SECTION: always show VEHICLE / RENTAL / PAYMENT tables if available ---- #}
{% if table_data %}
  {% for tname in ['VEHICLE', 'RENTAL', 'PAYMENT'] %}
    {% set t = table_data.get(tname) %}
    {% if t and t.rows %}
      <h2>Current {{ tname }} Records</h2>
      <table>
        <tr>
          {% for c in t.cols %}<th>{{ c }}</th>{% endfor %}
        </tr>
        {% for row in t.rows %}
          <tr>
            {% for cell in row %}<td>{{ cell }}</td>{% endfor %}
          </tr>
        {% endfor %}
      </table>
    {% endif %}
  {% endfor %}
{% endif %}

<a href="/"><button>Back to Main Menu</button></a>

<script>
  // show/hide field groups when the table dropdown changes
  function showSection(sel) {
    const tables = ["CUSTOMER","VEHICLE","RENTAL","PAYMENT"];
    tables.forEach(t => {
      const div = document.getElementById("section-" + t);
      if (div) {
        div.style.display = (t === sel ? "block" : "none");
      }
    });
  }

  const selectEl = document.getElementById("table-select");
  // initial state based on server-side selected_table
  showSection(selectEl.value);
  // update on change
  selectEl.addEventListener("change", function () {
    showSection(this.value);
  });
</script>

</body>
</html>
